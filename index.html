<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å•è¯è®°å¿†ç³»ç»Ÿ</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: #333;
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 30px;
            position: relative;
            overflow: hidden;
        }
        
        h1 {
            text-align: center;
            margin-bottom: 30px;
            color: #2c3e50;
            font-size: 2.5em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
        }
        
        .tabs {
            display: flex;
            margin-bottom: 25px;
            border-bottom: 2px solid #e0e0e0;
            background: #f8f9fa;
            border-radius: 10px 10px 0 0;
            overflow: hidden;
        }
        
        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }
        
        .tab:hover {
            background: #e9ecef;
        }
        
        .tab.active {
            background: #3498db;
            color: white;
            box-shadow: 0 2px 10px rgba(52, 152, 219, 0.3);
        }
        
        .tab-content {
            display: none;
            animation: fadeIn 0.5s ease-in;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .tab-content.active {
            display: block;
        }
        
        .word-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            border-left: 5px solid #3498db;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .word-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        }
        
        .word-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .word {
            font-size: 28px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .pronunciation {
            color: #7f8c8d;
            font-style: italic;
            font-size: 16px;
        }
        
        .meaning {
            font-size: 20px;
            color: #34495e;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
            border-left: 3px solid #27ae60;
        }
        
        .btn {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(52, 152, 219, 0.4);
        }
        
        .btn:active {
            transform: translateY(0);
        }
        
        .btn-group {
            display: flex;
            justify-content: space-between;
            margin-top: 25px;
            gap: 15px;
        }
        
        .btn-group .btn {
            flex: 1;
        }
        
        .progress-bar {
            height: 12px;
            background: #ecf0f1;
            border-radius: 10px;
            margin: 25px 0;
            overflow: hidden;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }
        
        .progress {
            height: 100%;
            background: linear-gradient(135deg, #27ae60, #2ecc71);
            width: 0%;
            transition: width 0.8s ease;
            border-radius: 10px;
        }
        
        .test-options {
            display: flex;
            flex-direction: column;
            gap: 12px;
            margin-top: 20px;
        }
        
        .test-option {
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: white;
            font-size: 16px;
        }
        
        .test-option:hover {
            border-color: #3498db;
            background: #f8f9fa;
            transform: translateX(5px);
        }
        
        .test-option.correct {
            background: #d4edda;
            border-color: #27ae60;
            color: #155724;
        }
        
        .test-option.incorrect {
            background: #f8d7da;
            border-color: #dc3545;
            color: #721c24;
        }
        
        .hidden {
            display: none !important;
        }
        
        .upload-area {
            border: 3px dashed #3498db;
            border-radius: 12px;
            padding: 40px;
            text-align: center;
            margin-bottom: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            background: #f8f9fa;
        }
        
        .upload-area:hover {
            background: #e3f2fd;
            border-color: #2980b9;
        }
        
        .upload-area.dragover {
            background: #bbdefb;
            border-color: #1565c0;
            transform: scale(1.02);
        }
        
        .stats {
            display: flex;
            justify-content: space-around;
            margin: 25px 0;
            text-align: center;
            gap: 15px;
        }
        
        .stat-item {
            flex: 1;
            padding: 20px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 12px;
            color: white;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .stat-label {
            font-size: 14px;
            opacity: 0.9;
        }
        
        .welcome-message {
            text-align: center;
            padding: 40px 20px;
            color: #7f8c8d;
        }
        
        .welcome-message h2 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        @media (max-width: 600px) {
            .container {
                padding: 20px 15px;
            }
            
            .tabs {
                flex-direction: column;
            }
            
            .word {
                font-size: 24px;
            }
            
            .btn {
                padding: 10px 20px;
                font-size: 14px;
            }
            
            .stat-value {
                font-size: 24px;
            }
        }

        .success-message {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #27ae60;
            margin: 15px 0;
        }

        .error-message {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            border-left: 4px solid #dc3545;
            margin: 15px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸš€ å•è¯è®°å¿†ç³»ç»Ÿ</h1>
        
        <div class="tabs">
            <button class="tab active" data-tab="learn">ğŸ“š å­¦ä¹ </button>
            <button class="tab" data-tab="review">ğŸ”„ å¤ä¹ </button>
            <button class="tab" data-tab="upload">ğŸ“¤ ä¸Šä¼ è¯åº“</button>
            <button class="tab" data-tab="stats">ğŸ“Š ç»Ÿè®¡</button>
        </div>
        
        <!-- å­¦ä¹ æ ‡ç­¾ -->
        <div class="tab-content active" id="learn">
            <div class="progress-bar">
                <div class="progress" id="learn-progress"></div>
            </div>
            <div id="word-cards">
                <div class="welcome-message">
                    <h2>æ¬¢è¿ä½¿ç”¨å•è¯è®°å¿†ç³»ç»Ÿï¼</h2>
                    <p>è¯·å…ˆä¸Šä¼ è¯åº“æ–‡ä»¶å¼€å§‹å­¦ä¹ </p>
                    <p>ğŸ‘‰ åˆ‡æ¢åˆ°"ä¸Šä¼ è¯åº“"æ ‡ç­¾é¡µ</p>
                </div>
            </div>
            <div class="btn-group">
                <button class="btn" id="prev-btn">â¬…ï¸ ä¸Šä¸€ç»„</button>
                <button class="btn" id="next-btn">â¡ï¸ ä¸‹ä¸€ç»„</button>
                <button class="btn" id="test-btn">ğŸ¯ å¼€å§‹æµ‹è¯•</button>
            </div>
        </div>
        
        <!-- å¤ä¹ æ ‡ç­¾ -->
        <div class="tab-content" id="review">
            <div id="review-cards">
                <div class="welcome-message">
                    <h2>å¤ä¹ æ¨¡å¼</h2>
                    <p>ä»Šå¤©æ²¡æœ‰éœ€è¦å¤ä¹ çš„å•è¯</p>
                    <p>å­¦ä¹ æ–°å•è¯åï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨å®‰æ’å¤ä¹ è®¡åˆ’</p>
                </div>
            </div>
            <div class="btn-group">
                <button class="btn" id="review-prev">â¬…ï¸ ä¸Šä¸€ä¸ª</button>
                <button class="btn" id="review-next">â¡ï¸ ä¸‹ä¸€ä¸ª</button>
            </div>
        </div>
        
        <!-- ä¸Šä¼ è¯åº“æ ‡ç­¾ -->
        <div class="tab-content" id="upload">
            <div class="upload-area" id="upload-area">
                <h3>ğŸ“ ä¸Šä¼ è¯åº“æ–‡ä»¶</h3>
                <p>ç‚¹å‡»æˆ–æ‹–æ‹½CSVæ–‡ä»¶åˆ°è¿™é‡Œ</p>
                <p><small>æ ¼å¼ï¼šå•è¯,å‘éŸ³,ä¸­æ–‡é‡Šä¹‰</small></p>
                <div style="margin-top: 20px; padding: 15px; background: #e9ecef; border-radius: 8px;">
                    <strong>ç¤ºä¾‹ï¼š</strong><br>
                    apple,/ËˆÃ¦pl/,è‹¹æœ<br>
                    banana,/bÉ™ËˆnÉ‘ËnÉ™/,é¦™è•‰<br>
                    computer,/kÉ™mËˆpjuËtÉ™(r)/,è®¡ç®—æœº
                </div>
            </div>
            <input type="file" id="file-input" accept=".csv" style="display: none;">
            <div id="upload-status"></div>
            <div class="btn-group">
                <button class="btn" id="download-sample">ğŸ“¥ ä¸‹è½½ç¤ºä¾‹è¯åº“</button>
            </div>
        </div>
        
        <!-- ç»Ÿè®¡æ ‡ç­¾ -->
        <div class="tab-content" id="stats">
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-value" id="total-words">0</div>
                    <div class="stat-label">æ€»å•è¯æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="learned-words">0</div>
                    <div class="stat-label">å·²å­¦å•è¯</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="review-words">0</div>
                    <div class="stat-label">å¾…å¤ä¹ </div>
                </div>
            </div>
            <div id="stats-details">
                <div class="welcome-message">
                    <h2>å­¦ä¹ ç»Ÿè®¡</h2>
                    <p>å¼€å§‹å­¦ä¹ åï¼Œè¿™é‡Œä¼šæ˜¾ç¤ºæ‚¨çš„å­¦ä¹ è¿›åº¦</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ç®€åŒ–çš„å•è¯ç®¡ç†ç³»ç»Ÿ
        class WordManager {
            constructor() {
                this.words = [];
                this.currentGroup = 0;
                this.reviewWords = [];
                this.loadData();
                console.log('WordManager initialized');
            }
            
            loadData() {
                try {
                    const saved = localStorage.getItem('wordManager_data');
                    if (saved) {
                        const data = JSON.parse(saved);
                        this.words = data.words || [];
                        this.currentGroup = data.currentGroup || 0;
                        this.reviewWords = data.reviewWords || [];
                    }
                    console.log('Data loaded:', this.words.length, 'words');
                } catch (e) {
                    console.error('Error loading data:', e);
                    this.words = [];
                    this.currentGroup = 0;
                    this.reviewWords = [];
                }
            }
            
            saveData() {
                const data = {
                    words: this.words,
                    currentGroup: this.currentGroup,
                    reviewWords: this.reviewWords
                };
                localStorage.setItem('wordManager_data', JSON.stringify(data));
            }
            
            uploadWords(csvText) {
                console.log('Uploading words...');
                const lines = csvText.split('\n');
                this.words = [];
                
                for (let i = 0; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (line) {
                        const parts = line.split(',');
                        if (parts.length >= 3) {
                            this.words.push({
                                word: parts[0].trim(),
                                pronunciation: parts[1].trim(),
                                meaning: parts[2].trim(),
                                learned: false
                            });
                        }
                    }
                }
                
                this.currentGroup = 0;
                this.saveData();
                console.log('Words uploaded:', this.words.length);
                return this.words.length;
            }
            
            getCurrentGroupWords() {
                const startIndex = this.currentGroup * 5;
                return this.words.slice(startIndex, startIndex + 5);
            }
            
            nextGroup() {
                if ((this.currentGroup + 1) * 5 < this.words.length) {
                    this.currentGroup++;
                    this.saveData();
                    return this.getCurrentGroupWords();
                }
                return null;
            }
            
            prevGroup() {
                if (this.currentGroup > 0) {
                    this.currentGroup--;
                    this.saveData();
                    return this.getCurrentGroupWords();
                }
                return null;
            }
        }

        // åˆå§‹åŒ–
        console.log('Initializing application...');
        const wordManager = new WordManager();
        
        // DOM å…ƒç´ 
        const elements = {
            tabs: document.querySelectorAll('.tab'),
            tabContents: document.querySelectorAll('.tab-content'),
            wordCards: document.getElementById('word-cards'),
            reviewCards: document.getElementById('review-cards'),
            prevBtn: document.getElementById('prev-btn'),
            nextBtn: document.getElementById('next-btn'),
            testBtn: document.getElementById('test-btn'),
            uploadArea: document.getElementById('upload-area'),
            fileInput: document.getElementById('file-input'),
            uploadStatus: document.getElementById('upload-status'),
            learnProgress: document.getElementById('learn-progress'),
            totalWords: document.getElementById('total-words'),
            learnedWords: document.getElementById('learned-words'),
            reviewWords: document.getElementById('review-words'),
            statsDetails: document.getElementById('stats-details'),
            reviewPrevBtn: document.getElementById('review-prev'),
            reviewNextBtn: document.getElementById('review-next'),
            downloadSample: document.getElementById('download-sample')
        };

        console.log('DOM elements loaded:', elements);

        // æ ‡ç­¾åˆ‡æ¢
        elements.tabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                console.log('Switching to tab:', tabId);
                
                // æ›´æ–°æ´»åŠ¨æ ‡ç­¾
                elements.tabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                // æ›´æ–°æ´»åŠ¨å†…å®¹
                elements.tabContents.forEach(content => {
                    content.classList.remove('active');
                    if (content.id === tabId) {
                        content.classList.add('active');
                    }
                });
                
                // åŠ è½½ç‰¹å®šæ ‡ç­¾çš„å†…å®¹
                if (tabId === 'learn') {
                    loadLearningContent();
                } else if (tabId === 'stats') {
                    loadStatsContent();
                }
            });
        });

        // åŠ è½½å­¦ä¹ å†…å®¹
        function loadLearningContent() {
            console.log('Loading learning content...');
            const currentWords = wordManager.getCurrentGroupWords();
            displayWordCards(currentWords);
            updateProgress();
        }

        // æ˜¾ç¤ºå•è¯å¡ç‰‡
        function displayWordCards(words) {
            console.log('Displaying word cards:', words);
            elements.wordCards.innerHTML = '';
            
            if (words.length === 0) {
                elements.wordCards.innerHTML = `
                    <div class="welcome-message">
                        <h2>æš‚æ— å•è¯</h2>
                        <p>è¯·å…ˆä¸Šä¼ è¯åº“æ–‡ä»¶</p>
                    </div>
                `;
                return;
            }
            
            words.forEach((word, index) => {
                const card = document.createElement('div');
                card.className = 'word-card';
                card.innerHTML = `
                    <div class="word-header">
                        <div class="word">${word.word}</div>
                        <div class="pronunciation">${word.pronunciation}</div>
                    </div>
                    <div class="meaning">${word.meaning}</div>
                `;
                elements.wordCards.appendChild(card);
            });
        }

        // æ›´æ–°è¿›åº¦æ¡
        function updateProgress() {
            const totalGroups = Math.ceil(wordManager.words.length / 5);
            const progress = totalGroups > 0 ? ((wordManager.currentGroup + 1) / totalGroups) * 100 : 0;
            elements.learnProgress.style.width = `${progress}%`;
        }

        // æŒ‰é’®äº‹ä»¶ç›‘å¬
        elements.prevBtn.addEventListener('click', () => {
            console.log('Previous group clicked');
            const words = wordManager.prevGroup();
            if (words) {
                displayWordCards(words);
                updateProgress();
            }
        });

        elements.nextBtn.addEventListener('click', () => {
            console.log('Next group clicked');
            const words = wordManager.nextGroup();
            if (words) {
                displayWordCards(words);
                updateProgress();
            }
        });

        elements.testBtn.addEventListener('click', () => {
            alert('æµ‹è¯•åŠŸèƒ½å°†åœ¨åç»­ç‰ˆæœ¬ä¸­å¼€æ”¾ï¼');
        });

        // æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½
        elements.uploadArea.addEventListener('click', () => {
            elements.fileInput.click();
        });

        elements.uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            elements.uploadArea.classList.add('dragover');
        });

        elements.uploadArea.addEventListener('dragleave', () => {
            elements.uploadArea.classList.remove('dragover');
        });

        elements.uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            elements.uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFileUpload(files[0]);
            }
        });

        elements.fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFileUpload(e.target.files[0]);
            }
        });

        function handleFileUpload(file) {
            console.log('Handling file upload:', file.name);
            if (file.type !== 'text/csv' && !file.name.endsWith('.csv')) {
                elements.uploadStatus.innerHTML = '<div class="error-message">è¯·ä¸Šä¼ CSVæ ¼å¼çš„æ–‡ä»¶</div>';
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const csvText = e.target.result;
                    const wordCount = wordManager.uploadWords(csvText);
                    elements.uploadStatus.innerHTML = `<div class="success-message">æˆåŠŸä¸Šä¼  ${wordCount} ä¸ªå•è¯ï¼</div>`;
                    
                    // è‡ªåŠ¨åˆ‡æ¢åˆ°å­¦ä¹ æ ‡ç­¾
                    document.querySelector('[data-tab="learn"]').click();
                    
                } catch (error) {
                    console.error('Error processing file:', error);
                    elements.uploadStatus.innerHTML = '<div class="error-message">æ–‡ä»¶å¤„ç†å‡ºé”™ï¼Œè¯·æ£€æŸ¥æ ¼å¼</div>';
                }
            };
            reader.onerror = () => {
                elements.uploadStatus.innerHTML = '<div class="error-message">æ–‡ä»¶è¯»å–å¤±è´¥</div>';
            };
            reader.readAsText(file);
        }

        // ä¸‹è½½ç¤ºä¾‹è¯åº“
        elements.downloadSample.addEventListener('click', () => {
            const sampleContent = `apple,/ËˆÃ¦pl/,è‹¹æœ
banana,/bÉ™ËˆnÉ‘ËnÉ™/,é¦™è•‰
computer,/kÉ™mËˆpjuËtÉ™(r)/,è®¡ç®—æœº
hello,/hÉ™ËˆlÉ™ÊŠ/,ä½ å¥½
world,/wÉœËrld/,ä¸–ç•Œ
book,/bÊŠk/,ä¹¦
pen,/pen/,é’¢ç¬”
teacher,/ËˆtiËtÊƒÉ™r/,è€å¸ˆ
student,/ËˆstuËdnt/,å­¦ç”Ÿ
school,/skuËl/,å­¦æ ¡`;
            
            const blob = new Blob([sampleContent], { type: 'text/csv' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'sample-vocabulary.csv';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        });

        // åŠ è½½ç»Ÿè®¡å†…å®¹
        function loadStatsContent() {
            const stats = {
                totalWords: wordManager.words.length,
                learnedWords: wordManager.words.filter(word => word.learned).length,
                todayReviewWords: wordManager.reviewWords.length
            };
            
            elements.totalWords.textContent = stats.totalWords;
            elements.learnedWords.textContent = stats.learnedWords;
            elements.reviewWords.textContent = stats.todayReviewWords;
            
            elements.statsDetails.innerHTML = `
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px;">
                    <h3>å­¦ä¹ è¿›åº¦</h3>
                    <p>æ€»å•è¯æ•°: ${stats.totalWords}</p>
                    <p>å·²å­¦ä¹ : ${stats.learnedWords}</p>
                    <p>å­¦ä¹ è¿›åº¦: ${stats.totalWords > 0 ? Math.round((stats.learnedWords / stats.totalWords) * 100) : 0}%</p>
                    <p>å¾…å¤ä¹ : ${stats.todayReviewWords} ä¸ªå•è¯</p>
                </div>
            `;
        }

        // åˆå§‹åŠ è½½
        console.log('Initial load completed');
        loadLearningContent();
        loadStatsContent();

        // æ·»åŠ è°ƒè¯•ä¿¡æ¯
        console.log('Application fully loaded');
        console.log('Current words:', wordManager.words.length);
        console.log('Current group:', wordManager.currentGroup);
    </script>
</body>
</html>
